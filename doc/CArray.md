# CArray 结构体文档

## 简介

`CArray`
结构体设计用于高效地处理和存储原始数据缓冲区，特别是针对数值计算场景。它封装了一个动态分配的字符数组 (`DataTrunk`)
以存储数据，并支持类型概念通过 `ConstelDateType` 枚举。目前仅支持 `CONSTEL_FLOAT32` 类型，未来计划扩展更多数据类型。

## 成员枚举

### ConstelDateType

- **CONSTEL_FLOAT32**: 表示缓冲区存储的数据类型为 32 位浮点数。

## 成员结构体

### DataTrunk

- **dptr_**: 指向动态分配内存的指针。
- **size_**: 分配内存的大小（字节）。

#### 特性

- **动态内存管理**：构造时根据给定的大小分配内存，析构时释放内存。
- **不可复制与移动**：禁用了拷贝构造函数、赋值运算符以及移动构造函数和移动赋值运算符，以避免悬挂指针或重复释放内存的问题。

## CArray 成员函数

### 构造函数

- **默认构造函数**：初始化一个空的 `CArray` 对象。
- **带大小参数的构造函数**：初始化一个指定大小的 `CArray` 对象，数据类型默认为 `CONSTEL_FLOAT32`。

### 拷贝控制

- **拷贝构造函数** 和 **赋值运算符**：默认实现，即复制`std::shared_ptr`，使得对象在多个地方使用时共享相同的数据。
- **移动构造函数** 和 **移动赋值运算符**：默认实现，支持资源的转移而非复制。

### 数据访问

- **data()**：返回指向内部数据缓冲区的指针。
- **size()**：返回内部数据缓冲区的大小（字节）。

### 数据操作

- **CopyFrom(const CArray& other)**：从另一个 `CArray` 对象中复制数据，即深拷贝，要求两个对象大小相同。
- **CopyFrom(const void* data, size_t size)**：从给定的原始数据和大小中复制数据到当前 `CArray` 对象，要求当前对象的大小与给定大小相匹配。

## 注意事项

- **数据类型支持**：当前版本只支持 `CONSTEL_FLOAT32` 数据类型，未来版本将扩展更多类型。
- **性能考量**：内存拷贝操作未利用 OpenMP 进行加速，对于大数据量操作可能影响性能。

## 示例用法

```c++
CArray array1(1024); // 创建一个大小为1024字节的CArray 
CArray array2; // 创建一个默认的空CArray 
array2.CopyFrom(array1); // 将array1的内容复制到array2
// 内存自动释放
```

## 未来工作

- **数据类型扩展**：扩展 `ConstelDateType` 枚举以支持更多数据类型。
- **性能优化**：实现内存拷贝操作的并行化加速。
- **功能增强**：考虑增加对复杂数据结构或元数据的支持，如形状信息，以更好地适应多维数组操作。
